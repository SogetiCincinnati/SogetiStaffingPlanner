
<div id="app" class="main">
    <div v-if="moreState === false">
        <template>
            <div class="flash-message">
                <transition name="fade">
                    <p v-if="message">{{ message }}</p>
                </transition>
            </div>
        </template>
        <h2>Position List</h2>
        <hr />

        <div v-if="addState === false" class="addButton">
            <button v-on:click="add" class="btn btn-primary">
                <i class="fa fa-pencil"></i> Add Position
            </button>
            <div class="form-group"></div>
        </div>
        <template v-else>
            <div class="addButton">
                <div class="form-horizontal">
                    <!-- ROW ONE BEGIN-->
                    <div class="col-sm-6">
                        <label class="col-sm-4" for="">Position Name: </label>
                        <div class="col-sm-8">
                            <input class="form-control" type="text" v-model="positionName" maxlength="200"/>
                            <span class="error">{{ errors.positionName }}</span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="col-sm-4" for="">Duration (months):</label>
                        <div class="col-sm-8">
                            <input class="form-control" type="number" name="quantity" min="1" max="1825" v-model="duration" />
                            <template v-if="errors.duration">
                                <span class="error">{{ errors.duration }}</span>
                            </template>
                        </div>
                    </div>
                    <div class="form-group"></div>

                    <div class="col-sm-6">
                        <label class="col-sm-4" for="">Accepted Candidate:</label>
                        <div class="col-sm-8">
                            <input class="form-control" type="text" v-model="acceptedCandidate" maxlength="200"/>
                            <template v-if="errors.acceptedCandidate">
                                <span class="error">{{ errors.acceptedCandidate }}</span>
                            </template>
                        </div>
                    </div>
                    <div class="col-sm-6">

                        <label class="col-sm-4" for="">Skillset:</label>
                        <div class="col-sm-8">
                            <input class="form-control" type="text" v-model="skillset" maxlength="200"/>
                            <template v-if="errors.skillset">
                                <span class="error">{{ errors.skillset }}</span>
                            </template>
                        </div>
                    </div>
                    <div class="form-group"></div>

                    <div class="col-sm-6">
                        <label class="col-sm-4" for="">Rate:</label>
                        <div class="col-sm-8">
                            <input class="form-control" type="number" name="quantity" min="30" max="1000" v-model="rate" />
                            <template v-if="errors.rate">
                                <span class="error">{{ errors.rate }}</span>
                            </template>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="col-sm-4" for="">Expected Start Date:</label>
                        <div class="col-sm-8">
                            <input class="form-control" type="date" min="1990-06-15" v-model="expectedStartDate" />
                            <template v-if="errors.expectedStartDate">
                                <span class="error">{{ errors.expectedStartDate }}</span>
                            </template>
                        </div>
                    </div>
                    <div class="form-group"></div>

                    <div class="col-sm-6">
                        <label class="col-sm-4" for="">Hire Candidate:</label>
                        <div class="col-sm-8">
                            <input class="form-control" type="text" v-model="hireCandidate" maxlength="200"/>
                            <template v-if="errors.hireCandidate">
                                <span class="error">{{ errors.hireCandidate }}</span>
                            </template>
                        </div>
                    </div>
                    <div class="col-sm-6">

                        <label class="col-sm-4" for="">Proposed Candidate:</label>
                        <div class="col-sm-8">
                            <input class="form-control" type="text" v-model="proposedCandidate" maxlength="200"/>
                            <template v-if="errors.proposedCandidate">
                                <span class="error">{{ errors.proposedCandidate }}</span>
                            </template>
                        </div>
                    </div>
                    <div class="form-group"></div>

                    <div class="col-sm-6">
                        <label class="col-sm-4" for="">Rejected Candidate:</label>
                        <div class="col-sm-8">
                            <input class="form-control" type="text" v-model="rejectedCandidate" maxlength="200"/>
                            <template v-if="errors.rejectedCandidate">
                                <span class="error">{{ errors.rejectedCandidate }}</span>
                            </template>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="col-sm-4" for="">Position Note:</label>
                        <div class="col-sm-8">
                            <input class="form-control" type="text" v-model="positionNote" maxlength="200"/>
                            <template v-if="errors.positionNote">
                                <span class="error">{{ errors.positionNote }}</span>
                            </template>
                        </div>
                    </div>
                    <div class="form-group"></div>

                    <div class="col-sm-6">
                        <label class="col-sm-4" for="">Number of Positions:</label>
                        <div class="col-sm-8">
                            <input class="form-control" type="number" name="quantity" min="1" max="1000" v-model="numberOfPositions" />
                            <template v-if="errors.numberOfPositions">
                                <span class="error">{{ errors.numberOfPositions }}</span>
                            </template>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="col-sm-4">Position Status: </label>
                        <div class="col-sm-8">
                            <select class="form-control" v-model="positionStatusId">
                                <option v-for="positionStatus in positionStatuses" :value="positionStatus.PositionStatusId">{{ positionStatus.PositionStatusName }}</option>
                            </select>
                            <template v-if="errors.positionStatusId">
                                <span class="error">{{ errors.positionStatusId }}</span>
                            </template>
                        </div>
                    </div>
                    <div class="form-group"></div>
                    <div class="col-sm-6">
                        <label class="col-sm-4">Opportunity: </label>
                        <div class="col-sm-8">
                            <select class="form-control" v-model="opportunityId">
                                <option v-for="opportunity in opportunities" :value="opportunity.OpportunityId">{{ opportunity.OpportunityName }}</option>
                            </select>
                            <template v-if="errors.opportunityId">
                                <span class="error">{{ errors.opportunityId }}</span>
                            </template>
                        </div>
                    </div>


                    <div class="col-sm-6">
                        <label class="col-sm-4">Unit Practice: </label>
                        <div class="col-sm-8">
                            <select class="form-control" v-model="unitPracticeId">
                                <option selected> ACT</option>
                            </select>
                            <template v-if="errors.unitPracticeId">
                                <span class="error">{{ errors.unitPracticeId }}</span>
                            </template>
                        </div>
                    </div>
                    <div class="form-group"></div>
                    <div class="col-sm-6">
                        <label class="col-sm-4">Min Consultant Grade: </label>
                        <div class="col-sm-8">
                            <select class="form-control" v-model="minConsultantGradeId">
                                <option v-for="grade in grades" :value="grade.GradeId"> {{ grade.GradeName }}</option>
                            </select>
                            <template v-if="errors.minConsultantGradeId">
                                <span class="error">{{ errors.minConsultantGradeId }}</span>
                            </template>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="col-sm-4">Max Consultant Grade: </label>
                        <div class="col-sm-8">
                            <select class="form-control" v-model="maxConsultantGradeId">
                                <option v-for="grade in grades" :value="grade.GradeId">{{ grade.GradeName }}</option>
                            </select>
                            <template v-if="errors.maxConsultantGradeId">
                                <span class="error">{{ errors.maxConsultantGradeId }}</span>
                            </template>
                        </div>
                    </div>
                    <!--/////////////FORM SUBMISSION AND CANCEL BUTTONS/////////////////-->
                    <div class="form-group"></div>
                    <div class="col-sm-6">
                        <button v-on:click="onSubmit"
                                class="btn btn-primary"
                                :disabled="errors.numberOfPositions || errors.opportunityId || errors.positionName || errors.positionStatusId">
                            <i class="fa fa-pencil"></i> Submit
                        </button>
                        <button v-on:click="cancel" class="btn btn-danger"><i class="fa fa-times"></i> Cancel</button>
                    </div>

                    <div class="form-group"></div>
                </div>
            </div>

        </template>


        <template>
            <div class="scrollBar">
                <table>
                    <tr>
                        <th>Position Name</th>
                        <th>Opportunity Name</th>
                        <th>Number of Positions</th>
                        <th>Duration</th>
                        <th>Accepted Candidate</th>
                        <th>Skillset</th>
                        <th>Rate</th>
                        <th>Edit</th>
                        <th>Details</th>
                        <!--<th>Delete</th>-->
                    </tr>
                    <tr v-for="(position, index) in positions">
                        <td v-if="index == selected" class="selected"> {{ position.PositionName }}</td>
                        <td v-else v-bind:class="{'inactivePosition' : !position.Active}">{{ position.PositionName }}</td>
                        <td v-if="index == selected" class="selected"> {{ getOpportunityName(position.OpportunityId) }}</td>
                        <td v-else v-bind:class="{'inactivePosition' : !position.Active}">{{ getOpportunityName(position.OpportunityId) }}</td>
                        <td v-if="index == selected" class="selected">{{ position.NumberOfPositions }}</td>
                        <td v-else v-bind:class="{'inactivePosition' : !position.Active}">{{ position.NumberOfPositions }}</td>
                        <td v-if="index == selected" class="selected">{{ position.Duration }}</td>
                        <td v-else v-bind:class="{'inactivePosition' : !position.Active}">{{ position.Duration }} months</td>
                        <td v-if="index == selected" class="selected">{{ position.AcceptedCandidate }}</td>
                        <td v-else v-bind:class="{'inactivePosition' : !position.Active}">{{ position.AcceptedCandidate }}</td>
                        <td v-if="index == selected" class="selected">{{ position.Skillset }}</td>
                        <td v-else v-bind:class="{'inactivePosition' : !position.Active}">{{ position.Skillset }}</td>
                        <td v-if="index == selected" class="selected">{{ position.Rate }}</td>
                        <td v-else v-bind:class="{'inactivePosition' : !position.Active}">${{ position.Rate }}</td>
                        <td v-bind:class="{'inactivePosition' : !position.Active}"><button class="btn btn-success" v-on:click="onEdit(position)"><i class="fa fa-edit"></i></button></td>
                        <td v-bind:class="{'inactivePosition' : !position.Active}"><button class="btn btn-warning" v-on:click="displayDetail(position)"><i class="fa fa-plus"></i></button></td>
                        <!--<td><button class="btn btn-danger"><i class="fa fa-trash"></i></button></td>-->
                    </tr>
                </table>
            </div>
        </template>
    </div>
    <!-- DISPLAY DETAILED INFORMATION ABOUT POSITION -->
    <template v-else>
        <button class="btn btn-warning" v-on:click="back">Back</button>
        <h3>{{this.positionDetail.PositionName}}</h3>
        <hr />
        <h5>Number of Positions: {{ this.positionDetail.NumberOfPositions }}</h5>
        <h5>Duration: {{ this.positionDetail.Duration }} Months</h5>
        <h5>Expected Start: {{this.positionDetail.ExpectedStartDate}}</h5>
        <h5>Position Status: {{ names.getPositionStatus(this.positionDetail.PositionStatusId, this) }}</h5>
        <h5>Unit Practice: ACT</h5>
        <h5>Opportunity: {{ getOpportunityName(this.positionDetail.OpportunityId) }}</h5>
        <br />
        <table>
            <tr>
                <th>Accepted Candidate</th>
                <th>Proposed Candidate</th>
                <th>Hire Candidate</th>
                <th>Rejected Candidate</th>
            </tr>
            <tr>
                <td>{{this.positionDetail.AcceptedCandidate}}</td>
                <td>{{this.positionDetail.ProposedCandidate}}</td>
                <td>{{this.positionDetail.HireCandidate}}</td>
                <td>{{this.positionDetail.RejectedCandidate}}</td>
            </tr>
            <tr>
                <th>Number of Positions</th>
                <th>Max Consultant Grade</th>
                <th>Min Consultant Grade</th>
                <th>Rate</th>
            </tr>
            <tr>
                <td>{{this.positionDetail.NumberOfPositions}}</td>
                <td>{{ names.getGradeName(this.positionDetail.MaxConsultantGradeId, this) }}</td>
                <td>{{ names.getGradeName(this.positionDetail.MinConsultantGradeId, this) }}</td>
                <td>${{this.positionDetail.Rate}}</td>
            </tr>
        </table>
        <br />
        <h4><strong>Skillset:</strong></h4>
        <h5>{{this.positionDetail.Skillset}}</h5>
        <h4><strong>Notes:</strong></h4>
        <p>{{this.positionDetail.PositionNote}}</p>
        <br />
        <h5><em>Last modified by: {{names.getLastModifiedUserName(this.positionDetail.LastModifiedUserId, this)}} on {{this.positionDetail.LastModified}}</em></h5>
        <button
                class="btn"
                v-bind:class="{'btn-info': !positionDetail.Active, 'btn-warning': positionDetail.Active}"
                v-on:click="toggleActive"
        >
            {{positionDetail.Active ? 'Make Inactive' : 'Make Active'}}
        </button>
    </template>
</div>
<script type="text/javascript" src="../../Scripts/App/Position/requests.js"></script>
<script type="text/javascript" src="../../Scripts/App/Position/position.js"></script>
<script type="text/javascript" src="../../Scripts/App/Position/names.js"></script>
<script type="text/javascript" src="../../Scripts/App/Position/helpers.js"></script>
<script type="text/javascript" src="../../Scripts/App/Position/validate.js"></script>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}